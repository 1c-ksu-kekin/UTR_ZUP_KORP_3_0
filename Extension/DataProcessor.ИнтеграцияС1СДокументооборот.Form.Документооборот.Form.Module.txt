
&НаСервере
Процедура ЮТР_ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	УстановитьВыполнениеПослеОбработчиковСобытия("ЮТР_ПриСозданииНаСервереПосле", Неопределено);
	
КонецПроцедуры

&НаСервере
Процедура ЮТР_ПриСозданииНаСервереПосле(Отказ, СтандартнаяОбработка, ДополнительныйПараметр)
	
	Если Отказ Или ЮТР_ДокументВходитВГрупповойПриказ(Параметры.ВнешнийОбъект) = Неопределено Тогда
		
		Возврат;
		
	КонецЕсли;
	
	ЮТР_ПроверитьВозможностьСозданияДокумента(Параметры.ВнешнийОбъект);
	
КонецПроцедуры

&НаСервере
Функция ЮТР_ДокументВходитВГрупповойПриказ(ВнешнийОбъект)
	
	Возврат ВнешнийОбъект.Ссылка.Метаданные().Реквизиты.Найти("ЮТР_ВключенВГрупповойПриказ");
	
КонецФункции

&НаСервере
Функция ЮТР_ПроверитьВозможностьСозданияДокумента(ВнешнийОбъект)
	
	Если ВнешнийОбъект.Ссылка.ЮТР_ВключенВГрупповойПриказ Тогда
		Запрос = Новый Запрос;
		Запрос.Текст = "ВЫБРАТЬ
		               |	ЮТР_ГрупповойПриказСписокДокументов.Ссылка
		               |ИЗ
		               |	Документ.ЮТР_ГрупповойПриказ.СписокДокументов КАК ЮТР_ГрупповойПриказСписокДокументов
		               |ГДЕ
		               |	ЮТР_ГрупповойПриказСписокДокументов.Документ = &Документ
		               |	И НЕ ЮТР_ГрупповойПриказСписокДокументов.Ссылка.ПометкаУдаления";
					   
		Запрос.УстановитьПараметр("Документ", ВнешнийОбъект.Ссылка);
		
		РезультатЗапроса = Запрос.Выполнить();
		Если НЕ РезультатЗапроса.Пустой() Тогда
			Элементы.ДекорацияОбъектСоздать.Доступность = Ложь;
			Элементы.ДекорацияОбъектВыбрать.Доступность = Ложь;
		КонецЕсли;
		
	КонецЕсли;

КонецФункции